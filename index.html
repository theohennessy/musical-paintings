<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Musical Paintings</title>
<style>
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  width: 100%;
  overflow: hidden;
  font-family: sans-serif;
  background: #000;
  display: flex;
  justify-content: center;
  align-items: center;
}

#container {
  position: relative;
  width: 100%;
  height: 100%;
}

#BG {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
}

#startOverlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.6);
  display: flex;
  justify-content: center;
  align-items: center;
  color: #FFF;
  font-size: 2rem;
  cursor: pointer;
  z-index: 10;
}

#restartBtn {
  position: absolute;
  top: 10px;
  right: 10px;
  z-index: 20;
  padding: 10px 15px;
  font-size: 1rem;
  cursor: pointer;
  background: rgba(0,0,0,0.5);
  color: #FFF;
  border: none;
  border-radius: 5px;
  display: none;
}

.hotspot {
  position: absolute;
  border-radius: 12px;
  cursor: pointer;
}

#HS1 { width: 180px; height: 120px; }
#HS2 { width: 180px; height: 90px; }
#HS3 { width: 120px; height: 90px; }

.overlay {
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  opacity: 0;
  pointer-events: none;
  transition: opacity 1s ease;
  object-fit: cover;
}
.overlay.visible { opacity: 1; }

audio { display: none; }
</style>
</head>
<body>

<div id="container">
  <img id="BG" src="BG.png" />

  <div id="HS1" class="hotspot" style="top:54%; left:74%;"></div>
  <div id="HS2" class="hotspot" style="top:52%; left:56%;"></div>
  <div id="HS3" class="hotspot" style="top:50%; left:25%;"></div>

  <img id="IMG1" class="overlay" src="IMG1.png" />
  <img id="IMG2" class="overlay" src="IMG2.png" />
  <img id="IMG3" class="overlay" src="IMG3.png" />

  <audio id="MP31" src="MP31.mp3" muted playsinline preload="auto"></audio>
  <audio id="MP32" src="MP32.mp3" muted playsinline preload="auto"></audio>
  <audio id="MP33" src="MP33.mp3" muted playsinline preload="auto"></audio>

  <div id="startOverlay">Start</div>
  <button id="restartBtn">Restart</button>
</div>

<script>
const audios = ["MP31","MP32","MP33"].map(id => document.getElementById(id));
let audioStarted = false;

const startOverlay = document.getElementById("startOverlay");
const restartBtn = document.getElementById("restartBtn");

// Start audio & fullscreen
function startAudio(event) {
  event.preventDefault();
  if (audioStarted) return;

  // Request fullscreen
  if (document.documentElement.requestFullscreen) {
    document.documentElement.requestFullscreen().catch(()=>{});
  } else if (document.documentElement.webkitRequestFullscreen) {
    document.documentElement.webkitRequestFullscreen();
  }

  // Play first audio to unlock mobile
  audios[0].muted = false;
  audios[0].volume = 0;
  audios[0].play().catch(e => console.log("Play failed:", e));

  audioStarted = true;
  startOverlay.style.display = "none";
  restartBtn.style.display = "block";
}

// Hotspot toggle logic
function bindToggle(hsId, imgId, audioIndex) {
  const hs = document.getElementById(hsId);
  const img = document.getElementById(imgId);
  const audio = audios[audioIndex];
  let visible = false;

  function toggle(event) {
    event.preventDefault();
    if (!audioStarted) return;
    visible = !visible;
    img.classList.toggle("visible", visible);
    fadeAudio(audio, visible ? 1 : 0, visible ? 200 : 300);
  }

  hs.addEventListener("click", toggle);
  hs.addEventListener("touchstart", toggle, { passive: false });
}

// Audio fade helper
function fadeAudio(audio, target, duration) {
  const steps = 8;
  const stepTime = duration / steps;
  const start = audio.volume;
  const diff = target - start;
  let i = 0;

  const fade = setInterval(() => {
    i++;
    audio.volume = start + diff * (i/steps);
    if (i >= steps) {
      clearInterval(fade);
      if (target === 0) audio.muted = true;
    }
  }, stepTime);
}

// Restart function
function restart() {
  // Reset overlays
  ["IMG1","IMG2","IMG3"].forEach(id => document.getElementById(id).classList.remove("visible"));

  // Reset audio
  audios.forEach(a => {
    a.pause();
    a.currentTime = 0;
    a.muted = true;
    a.volume = 0;
  });

  audioStarted = false;
  startOverlay.style.display = "flex";
  restartBtn.style.display = "none";
}

// Bind events
startOverlay.addEventListener("touchstart", startAudio, { passive: false });
startOverlay.addEventListener("click", startAudio);
restartBtn.addEventListener("click", restart);

bindToggle("HS1", "IMG1", 0);
bindToggle("HS2", "IMG2", 1);
bindToggle("HS3", "IMG3", 2);
</script>

</body>
</html>
